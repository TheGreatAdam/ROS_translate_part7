# 7.4.2 Угловая калибровка

Если у вас есть TurtleBot на основе iRobot Create, не используйте этот метод. Вместо этого запустите процедуру [автоматической калибровки](http://wiki.ros.org/turtlebot_calibration/Tutorials/Calibrate%20Odometry%20and%20Gyro) TurtleBot.

В этом тесте ваш робот будет вращаться только на месте, поэтому пространство не является большой проблемой. Поместите маркер \(например, кусок ленты\) на пол и выровняйте его по центру спереди робота. Мы повернем робота на 360 градусов и посмотрим, насколько близко он вернется к отметке.

Поднимите базовый контроллер вашего робота с соответствующим файлом запуска. Для оригинального TurtleBot \(база iRobot Create\), вставьте ssh в ноутбук робота и запустите:

```text
$ roslaunch rbx1_bringup turtlebot_minimal_create.launch
```

Далее запустите узел угловой калибровки:

```text
$ rosrun rbx1_nav calibrate_angular.py
```

Наконец, запустите rqt\_reconfigure:

```text
$ rosrun rqt_reconfigure rqt_reconfigure
```

Вернитесь в окно rqt\_reconfigure и выберите узел calibrate\_angular. \(Если вы не видите в списке узла calibrate\_angular, щелкните синий значок обновления в правом верхнем углу графического интерфейса.\) Чтобы начать тестирование, установите флажок рядом с start\_test. \(Если робот не начинает двигаться, снимите флажок и установите его снова.\) Ваш робот должен вращаться примерно на 360 градусов. Не беспокойтесь, если он вращается значительно больше или меньше, чем полный оборот. Это то, что мы собираемся исправить. Чтобы получить поправочный коэффициент, выполните следующие действия:

* Если фактическое вращение не дотягивает до полных 360 градусов, посмотрите на долю, которую он повернул, и введите оценочную долю в поле odom\_angular\_scale\_correction в окне rqt\_reconfigure. Поэтому, если робот выглядит примерно на 85%, введите что-то вроде 0,85. Если он повернулся на 5% слишком далеко, введите что-то вроде 1.05.
* Повторите тест, выровняв маркер по переднему центру робота, затем установите флажок start\_test в окне rqt\_reconfigure. 
* Надеемся, что поворот будет ближе к 360 градусам. Если он все еще короткий, уменьшите theodom\_angular\_scale\_correctionparameteralittleandtryagain. Если он вращается слишком далеко, увеличьте его немного и попробуйте снова. 
* Продолжайте процедуру, пока не будете удовлетворены результатом.

То, что вы делаете с вашим окончательным поправочным коэффициентом, зависит от параметров PID вашего базового контроллера. Для робота, контролируемого базовым контроллером ArbotiX, отредактируйте файл конфигурации YAML и измените параметр base\_width, разделив его на свой поправочный коэффициент.

В качестве последней проверки запустите файл запуска вашего робота с новым поправочным коэффициентом. Затем запустите сценарий calib\_angular.py, но с параметром odom\_angular\_scale\_correction, равным 1.0. Теперь ваш робот должен вращаться на 360 градусов без дальнейшей коррекции.

